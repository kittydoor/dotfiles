# gdisk /dev/sda, partitions:
# - esp /dev/sda1 ef00 1G /efi
# - boot /dev/sda2 8300 1G /boot
# - lvm /dev/sda3 8e00 384G / and /home
sgdisk -o /dev/sda
sgdisk -n 1:0:+1G -t 1:ef00 /dev/sda
sgdisk -n 2:0:+1G -t 2:8300 /dev/sda
sgdisk -n 3:0:+384G -t 3:8e00 /dev/sda

# esp
mkfs.fat -F 32 -n ESP /dev/sda1

# boot
cryptsetup luksFormat /dev/sda2
cryptsetup open /dev/sda2 cryptboot
mkfs.ext4 -L boot /dev/mapper/cryptboot

# lvm
cryptsetup luksFormat --type luks2 /dev/sda3
cryptsetup open /dev/sda3 cryptlvm
pvcreate /dev/mapper/cryptlvm
vgcreate cryptlvm /dev/mapper/cryptlvm # could also be named differently
lvcreate -L 128G cryptlvm -n root
lvcreate -l 100%FREE cryptlvm -n home
mkfs.ext4 -L root /dev/cryptlvm/root
mkfs.ext4 -L home /dev/cryptlvm/home

# mounting
mount /dev/cryptlvm/root /mnt

mkdir /mnt/home
mkdir /mnt/efi
mkdir /mnt/boot

mount /dev/cryptlvm/home /mnt/home
mount /dev/sda1 /mnt/efi
mount /dev/mapper/cryptboot /mnt/boot
